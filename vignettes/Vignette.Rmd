---
title: "Visualization with `anvis`"
author:
- name: Robert Koetsier
  affiliation: Wageningen University, Wageningen, The Netherlands
- name: Sanjeevan Jahagirdar
  affiliation: Wageningen University, Wageningen, The Netherlands
output: 
  BiocStyle::html_document:
    toc: true
    toc_depth: 2
    toc_float: true
package: anvis
abstract: >
  Creating and customizing network visualizations.
vignette: >
  %\VignetteIndexEntry{Visualization with anvis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction 

## About `anvis`

The `anvis` package was developed to automate the process of creating network visualizations. It generates styling for visual properties of networks to highlight the most relevant edges and nodes. In addition, the package can be used to create visualizations for multiple networks at once, allowing for easy comparison of similar networks. For creating visualizations this package relies on software that is popular for network visualization: [Cytoscape](https://cytoscape.org/) (accessed with `r Biocpkg("RCy3")`), and `r CRANpkg("igraph")`. Any user familiar with this software will be easily able to extend and customize the visualizations made with `netvis`. To provide the freedom to make visualizations with other software, `netvis` offers exports of networks and the added attributes (e.g. node size and edge color) in various common formats. To obtain the best results relatively small networks (< 150 nodes) should be used. For visualization of larger networks we refer users to the package `r Biocpkg("netbiov")`, as this package offers a variety of options aimed at visualization of large networks. 

Paragraph of bioconductor guidelines for vignette introduction section:

Add an “Introduction” section that serves as an abstract to introduce the objective, models, unique functions, key points, etc that distinguish the package from other packages in the same area. This is a requirement of Bioconductor package vignettes. It should include a short motivation for the package in general as well as motivation for inclusion of the package in Bioconductor. When relevant, a brief review and comparison of packages with similar functionality or scope should be provided either in the Introduction or in a separate dedicated vignette section.

## Installation

For installation of the package run the following code:

```{r installation, eval=FALSE}
if (!requireNamespace("BiocManager", quietly=TRUE))
    install.packages("BiocManager")
BiocManager::install("anvis")
```


# How to use - Basic example

Here we will give some demonstrations. Start by loading the package.

```{r loading}
library(anvis)
```

## Brief introduction of example data




# Data preparation

* adjacency matrix
* edgelist can be used, by converting to to adjacency 




# Creating networks & Options for adding attributes 

These attributes can all be added in a single step. To demonstrate the available options and their effect we list them below.

* Explanation of criteria for in input:
    + Square matrix with names
    + List of matrices, names can be used in grid
  
    
## Creating basic networks

* Adding edge directionality or self loops
    
    
## Node grouping

* group vector either one for all networks or one for each
* color of groups can be changed
* colorblind accessible option is available


## Node size

* How is connectivity calculated
* nodes can be arranged by size (connectivity)


## Edge width

* Explain the different types of methods that are available to calculate edge width
* there is an option available to rescale these edge widths
* The argument in the wrapper is vectorized
   
   
## Edge colors

### Available color spectra

* Diverging and sequential
    
### Changing edge colors with custom color function

* `Rcoloramp` can be used to convert colors to a spectrum. 
* demonstrate how to flip color spectra: 

```{r color_func}
# when the colors are opposite of what you expect
my_cols <- function (n) rev(pals::magma(n))
```

* Colors go from low to high values
* for positive and negative weights the colors are split into two halves, to be assigned to either sign


# Visualizing with igraph


## Changing the layout of the nodes

* Explain how alternative layouts can be used, and how the node order can be maintained


## Visualization of multiple networks

* Options to visualize side by side
* manually adjust the layout of the grid
* add titles to the grid elements, either by hand or from the names of the list
* Point out that it can be helpful to change the margins

##  saving of the visualizations

* export types
* further export options


## Further customization

* give some examples, to demonstrate that the full set of options of igraph is still available
    + Change graphical parameter options with `par()` 
    + Various options because of the flexibility of igraph
    + radial labels have their own options to be adjusted

## Directionality

* Arrows, self loops
* Recommend to use cytoscape instead of igraph since it looks neater



# Visualizing cytoscape


## Options for showing the visualizations

* Save image
    + export types
    + further export options
* Saving session
* Close session


## Visualization of multiple networks

* Multiple networks can be visualized, but they are either show in the session or saved seperately. No option to show side by side. 
* One option to show graphs side by side: - [arrange network windows](http://manual.cytoscape.org/en/stable/Quick_Tour_of_Cytoscape.html#:~:text=Arrange%20Network%20Windows)
* for easiest comparison we recommend igraph


## Directionality

* Arrows, self loops


## Customization 

* Setting more node space


## Using `r Biocpkg("RCy3")` for further customization

* Show at least one example to change some visual features of the network.


# Exporting the networks

* make a note on how the exports can include the columns that have info for visual styling
* Example with xgmml and another type
* file save name and xgmml title

# Session info

This vignette was made with `r CRANpkg("rmarkdown")` and `r Biocpkg("BiocStyle")`. Below the output generated by `sessionInfo()` when this document was compiled:

```{r sessionInfo, echo=FALSE}
sessionInfo()
```


